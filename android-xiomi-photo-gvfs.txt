| android
| Android

как выйти из fastboot режима как вывести телефон из этого режима?
на компе запускаем

  $ fastboot reboot




| android
| Android
| xiaomi
| xiomi
| photo
| gvfs

как воткнуть телефон через usb прововод в комп и скопировать фотографии
с в комп

обмен фотками идет через проотокол PTP (Photo Tranfer Protocol)

во первых возможно нужны эти службы но это неточно я не проверял работает ли
если их вырубить

$ systemctl --user --type=service list-units | grep gvfs
  gvfs-afc-volume-monitor.service     loaded active running Virtual filesystem service - Apple File Conduit monitor     
  gvfs-daemon.service                 loaded active running Virtual filesystem service                                  
  gvfs-goa-volume-monitor.service     loaded active running Virtual filesystem service - GNOME Online Accounts monitor  
  gvfs-gphoto2-volume-monitor.service loaded active running Virtual filesystem service - digital camera monitor         
  gvfs-metadata.service               loaded active running Virtual filesystem metadata service                         
  gvfs-mtp-volume-monitor.service     loaded active running Virtual filesystem service - Media Transfer Protocol monitor
  gvfs-udisks2-volume-monitor.service loaded active running Virtual filesystem service - disk device monitor            




далее втыкаем телефон через провод в комп и в меню телефона(там само выскочит меню) выбираем PTP (photography
transfer protocol)


теперь на компе вводим

$ gphotofs  ~/Pictures/02

все можно идти в папку и проеряеть что фотки видны

чтобы отмонтвать телеофон с компа вводим

$ fusermount -u   ~/Pictures/02


| File transfer


следущий вопрос окей мы получили с компа доступ к фоткам а как получить доступ
ко всем остальным файлам на телефоне.

для этого втыкаем телефон в комп и выбираем "File Transfer/Android Auto"

далее на компе 
  (юзаю статью https://www.baeldung.com/linux/mounting-mtp-devices)

маунтинг файлов идет через MTP протокол (Media Transfer Protocol)
который является как это ни смешно некой частью протокола PTP ( о котором мы говорили
выше ) протокола (https://en.wikipedia.org/wiki/Media_Transfer_Protocol)

итак на компе тыкаем

  $ gio mount -li
  Volume(0): Redmi 9
  Type: GProxyVolume (GProxyVolumeMonitorMTP)
  ids:
   unix-device: '/dev/bus/usb/001/055'
  activation_root=mtp://%5Busb%3A001,055%5D/
  themed icons:  [phone]
  symbolic themed icons:  [phone-symbolic]  [phone]
  can_mount=1
  can_eject=0
  should_automount=1

выясняем "маунт точку" телефона это 
  mtp://%5Busb%3A001,055%5D/


ксати если при запуске этой команды мы видим ругательства вида
  
  failed for remote volume monitor with dbus name org.gtk.vfs.UDisks2VolumeMonitor

это значит нужно через systemctl  --user запустить недостающую службу (хотя по мне это не влияет 
на конечный результат)

  $ systemctl --user start   gvfs-udisks2-volume-monitor.service


если gio нам показывает следущую ошибку
  
  invoking IsSupported() failed for remote volume monitor with dbus name org.gtk.vfs.GoaVolumeMonitor

значит нам нужно запусить еще одну службу под текущим юзером

  $ systemctl --user start   gvfs-goa-volume-monitor.service

  
хотя повторюсь не уверен что это влияет на конечный результат
в итоге у нас вот такие службы "gvfs*" должны раобтать под текущим юзером

  $ systemctl --user --type=service list-units | awk '{print$1}'
  gvfs-afc-volume-monitor.service
  gvfs-daemon.service
  gvfs-goa-volume-monitor.service
  gvfs-gphoto2-volume-monitor.service
  gvfs-metadata.service
  gvfs-mtp-volume-monitor.service
  gvfs-udisks2-volume-monitor.service


вообще что такое gio. это согласно этому сайту (https://wiki.ubuntuusers.de/gio/)
это "Gnome Input Output" хрень которая как я понял позволяет подмонтировать какой
нибудь ресурс в некоторую папку а потом какое нибудь gnome графическое приложение
читая с этой папки может "прилепить" содержимое этой папки в граф окне. нарпимер 
мы воткнули телефон. gio его смонтировала в папку а файл менеджер Nautilus нам
"прозрачно" показыает содержимое телефона.  
забегая вперед хочу сказать что у меня LXDE и у него файл менеджер PCmanFM
и вот в нем нихрена не пояявляется содержимое телефона даже после того как я через gio
подмонтировал теелеофон в некоторую папку. я еще коснусь Nautilus чуть пониже.

я еще  в сторону отойду. вот мы воткнули usb устройство. какой у нас /dev создается?
ответ никакой. созданием\несозданием занимается сервис udev ксатии он крутится
в этом процессе
  /lib/systemd/systemd-udevd
так вот при воктнутии usb устройства в частности теелефона у нас в /dev нихрена ничего
несодается. почему не знаю.

итак я втыкаю теелефон в комп
и udevadm monitor покаызает


 $ udevadm monitor
KERNEL[1380596.520234] add      /devices/pci0000:00/0000:00:14.0/usb1/1-3 (usb)
KERNEL[1380596.522955] add      /devices/pci0000:00/0000:00:14.0/usb1/1-3/1-3:1.0 (usb)
KERNEL[1380596.523400] add      /devices/pci0000:00/0000:00:14.0/usb1/1-3/1-3:1.1 (usb)
KERNEL[1380596.523644] bind     /devices/pci0000:00/0000:00:14.0/usb1/1-3 (usb)
UDEV  [1380597.097052] add      /devices/pci0000:00/0000:00:14.0/usb1/1-3 (usb)
UDEV  [1380597.104524] add      /devices/pci0000:00/0000:00:14.0/usb1/1-3/1-3:1.0 (usb)
UDEV  [1380597.107264] add      /devices/pci0000:00/0000:00:14.0/usb1/1-3/1-3:1.1 (usb)
UDEV  [1380597.112027] bind     /devices/pci0000:00/0000:00:14.0/usb1/1-3 (usb)


правла пиздец в том что этот вывод он не покзваывает создаются ли какието 
устройтва в /dev папке

но можно выяснить это правда через жопу
вот так

$ for i in `find . -maxdepth 1 -type c `; do echo -n "i=$i" ; udevadm info /dev/input/"$i" | grep DEVPATH | grep 'pci0000:00/0000:00:14.0/usb1/1-3' ; done

и нам выдастся ноль. 
итак с этой частью вопроса разобрались

двигаю дальше
итак после такой вводной возвращаемся к нашей ситауции. я воткнул телефон через USB
провод в комп, выбрал в телефоне в меню  
    
    "File Transfer/Android Auto"

потом я ищу телефон на компе

  $ gio mount -li | grep mtp
  activation_root=mtp://%5Busb%3A001,081%5D/    <=======


теперь когда я нашел "точку монтирования" ее можно примонтировать
делается это так

  $ gio mount "mtp://%5Busb%3A001,081%5D/" 

можно примонтировать и по другому
  $ lsusb
  Bus 001 Device 081: ID 2717:ff48  

тогда можно примонтирвать вот так
  $ gio mount "mtp://[usb:001,081]/" 

в скобках мы указываем   Bus 001 Device 081


по сути символы %5B  %3A  %5D  в строчке   mtp://%5Busb%3A001,081%5D/ 
котрую выдает gio mount -li 
это по сути hex коды ascii таблицы а именно
  %5B = [
  %3A = :
  %5D = ]

поэтому по сути эти две строки это одно и тоже
  mtp://%5Busb%3A001,081%5D/
  mtp://[usb:001,081]/


если я выберу в меню теелефона      "File Transfer/Android Auto"
то в строке маунтинга gio выдаст 
    activation_root="mtp://"
а если выберу в меню "Transfre photos PTP "
то gio выдаст 
    activation_root=gphoto2://...


итак я делаю маунтинг 
    $ gio mount "mtp://[usb:001,081]/" 

теперь папку с файлами можно найти тут
      /run/user/1000/gvfs

победа! это именно та конечная точка которую мы хотели получить!

отмонтировать можно вот так
  $ gio mount -u "mtp://[usb:001,081]/"

ксатии вот так мы будем иметь
  $ mount | grep gvf
  gvfsd-fuse on /run/user/1000/gvfs type fuse.gvfsd-fuse (rw,nosuid,nodev,relatime,user_id=1000,group_id=1000)

ксати эта строчка существует внезавивисмости мы щас смонтировали теелефон или нет

еще замечу что если мы на телефоне нажали "PTP"
то мы можем смонтировть папку двумя путями

  примонтировать: $ gphotofs  "~/Pictures/02"
  отмонтировать:  $ fusermount -u "~/Pictures/02"
либо
  примонтировать: $ gio mount "gphoto2://%5Busb%3A001,081%5D/"
  отмонтировать:  $ gio mount -u "gphoto2://%5Busb%3A001,081%5D/"




далее вот что про наутилус. если я его запускаю
  $ nautilus
и втыкаю теелефон то  происходит вот что - мы выбираем на телефоне в меню либо
  "PTP ..."
либо
  "Android ..."
тогда на /sys у нас появялется новое устройтво
и gi mount -li   фиксирует новое устройство  но устройство еще не маунтится
ни в какую папку. но если у нас запущен nautilus то уже покажет устройство "Redmi 9"
а если мы в найтилус тыкнем на значок "Redmi 9" то тогда уже gio монтирует устройство
автоматом в /run/user/1000/gvfs/....
вот так работает эта шарманка

чтобы не ебаться  с этим вопросом руками то проще всего запустить наутилус
и в нем тыкать сразу на графические символы

| Android
| smooth

как отключить анимацию 
  Settings - Additional settings - Accessibility - Vision - Remove animation




| Android
| notes
| MIUI notes

как перекопировать файлы созданные через notes на комп.
как я понял едисныенный вариант это поставить на теелефон "google keep"
и на теефлне copy\past с одной проги в другую. а потом мы на компе открываем гугл почту.
справав выбираем значок 
   ...
   ...
   ...

и там ищем "keep"

таким макамро мы получем текстовый файл с телеофона на компе. ура.

| Android
| adb

вот эта команда 
  $ adb backup -apk -obb -shared -all -system -f fullbackup.ab
она практиечески нихрена не ничего не бэкапит мне кажется. 



| Android
| xiaomi
| dual apps

есть такая хуйня. выбирается в меню. дает то что у нас появляется 
как мимнимум +1 копия приложения. например вацап или iron blade.
идешь в меню ищешь dual apps. там появется список программ уставноленных.
выбираешь и в ее свойствах активируешь dual apps. и андроид создает +1 значок
этой проги.и если на него нажать то эта прогиамма занвоо инцилизируется. таким маккром
например можно иметь два разых вацапа. также важно что сама прога должна поддреживать
эту фичу. 


| Android
| Whatsapp

на счет защиты входа в устанолвенный вацап.
можно заюзать "chat lock". выбираем чат. своства . lock chat. 
и тогда в списке чатов будет папка locked chats и чтобы туда попасть нужно либо face id
пройти либо фингепринт. к сожалению по паролю нихрена недоступно.
поэтому это не подоходит.

можно зайти в seetings-account- twostep verification
итам установить PIN код.

но он не для того чтобы защитить вход в устаноывелнный вацаап. он для другого. 
если ставить вацап на новый телефон то на одном из шагов вацап спросит этот pin код 
и если ты его незнаешь то пошел нахер установки не будет именно этого акаунта.

поэтому если хочется защитить вход в вацап паролем то по мне так сам вацаап это недает
сделать. и нужно юзать ксиоми "app lock"

есть еще фича pass key
  seetings-account- passkeys

как это работает что это дает. когда мы ставим вацап на новый телефон то 
он присылает на указанный номер смс либо звонит на номер.  если звонит то он лезет 
в список звонков чтобы найти этот номер если смс шлет то всего навсего надо в вацап ввести
номер из смски. 
так вот они решили что можно пойти другим путем. 
внутри телефона (незнаюгде) формируется RSA Private key. а на сервере вацапа сохранятеся
Public key. и тогда при установке вацапа  сервер не шлет нам смс. 
а происходит вот как так как на нашем теелефоне private key то мы делаем "digital signing".
диджитал сайнинг работает как так - мы у себя на телефоне вычисляем хеш от заранее некоей
заданной хрени. потом мы этот хеш шифруем приватным ключом. сервер вацапа тоже сам вычисляет
хеш от той же хрени (что за хрень не знаю предпожим это номер теелефона акаунта)
а далее используя пбуличный ключ сервер вацапа расшифроваывает то что мы ему присалли 
зашироыванным. и срваниваем хэш который был нами зашифрован с хешем который он сам посчитал.
если свопадает то это доазывает что данные были присланы именно с нашего телефона то есть
с теелфона который владее приватным ключом от публичного который хранится на сервере вацапа.
возгикает вопрос. если мы сформировали passkey. он где то нвутри записался на теелфоне.
потом мы форматунли теелфон или стерли вацап , откуда при повторойной установке на телефоне
возтмьмется этот private ключ или passkey. ответ вот какой - ксоми(андроид) поимо нашего
телефона сохраняет этот ключ на  password manager от гугл акаунта под коорым работает 
телефон.  через веб морду браузера можно посмтреть что это за хрень Pssword manager
    
      https://passwords.google.com/


если мы набрем эту ссылку то даже если мы быои аутентиифицрованы то еще раз гугл запросит
у нас пароль от акаунта. и там будет показано что сохранен пароль от вацап. 
поэтому как тлоько у нас на телфоне "подключен" гугл акаунт то ему доступен этот пртватный ключ.
наверно он копируется на теелфон при этом. и тода кодда мы ставим вацап. и на сервере вацапа
указано что для этого вацап номера был соформирован приватны ключ ака паасскей то он "его ищет"
на этом телефоне по схеме что я выше описал. 

в целом при устновке на теелефон вацапа работает седующая схема - если у нас для этого номра
вацапа уже установлен на другом теелефоне вацап то чтобы на этом телефоне он заработал 
этот вацап напишет что на тот вацап он послал код. и что нам нужно на этом вацапе вбить код
с того вацапа. если мы код не вобьем то вацап на этом телефоне не активиурется. это чтбы
нельзя было "украсть" вацап с одного телефона на другой. если  в свойствах акаунта вацапа
был также актвирован PIN то он тоже его спросит . иначе пошел нахер и он не актируиурется
на этом телефоне. если у мы активировали пасскод. а как я уже сказал если его нет на 
телефоне то он есть в password manager от того гугл акаунта под которым работал тот 
телефон на котором этот пасскод создавался. так вот вацап будет искать этот пасскод 
на новом телефоне. и если на новом телеофоне у нас не тот гугл акаунт который был на том 
телефоне то ( я проверил) вацап напишет что мол зайди на тот вацап на том телефоне 
и принеси сюда код переноса что мол тот вацап дает добро на перенос, хотя на том компе 
тот вацап уже может быть удален. и тогда надо либо на новом телефоне подкочаьт гугл 
акаунт который был на том телефоне либо на том телефоне ставить обратно вацап и 
принрсить оттуда код переноса , кода согласия что владеделец того телефона не против
"отдать " этот вацап на этот теелфон. на счет пасскода. он точно используется при 
установке вацапа на новом телефоне при условии что он был активиорван на старом телефоне.
но я не понял исползуется ли он при уже работе вацапа. спрашивается ли он или нет. 

как я понимаю если мы временно удаляем вацап с телефона то наежный споособ 
недать возможность поставить вацап на другой телефон это 
    1) актиировать PIN
    2) активировать пасскод 
    3) удалить вацап с телефона.
    4) держать в секрете на каком гугл акаунте был создан пасскод


теперь при попытаке усатнвить вацап с этим номером акаунта вацапа на каком то 
телефоне. установщие запросит PIN , также установщик запросит код согласия на перенос 
с того старого телефона. никаких смс звноков он не будет делать на новый телефон. 
если бы мы не активировали пасскод на старо телефоне и удали ли бы там ваацап то 
на новом телеонфе сервер толко спросил бы пин. он знает что мы удалии вацап на старом.
но так как мы акивировали пасскод то неважно удалили мы вацап на старом или нет.
срввер на новом телефоне будет ожидать либо тоо что на новом телефоне подколючен 
гуг акаунт такой же как был на старом телефоне. а если акаунт другой тоесть пасскод
если не обнаружен то будет писать что принеси со старого телфона код разрешения на
перемещения акаунта.

если мы хотим запретить установку вацапа на каком то телефоне то 
надо задать PIN. и не сказать. и надо чтобы вацап стоял на уже другом телефоне. 
или если он нигде не стоит чтобы был задан пасскод. а вкаком он гугл акаунте
хранится держатьв серкерете.

также окызвается вацап позволяет иметь неколько однвоерменно телфонов которые могут
иметь активный вацап акаунт. для этого надо на новом телефоне в меню там где номер 
запмывается ввреху српва нажать на значок "..." и выбрать "linked device" тогда
на новом телефоне у нас вылезет qr код. если на старом телефоне выбрать llinked device
и прочитаь этот qr код то на новом телефоне активруется дубликат вацапа старого телефона.
написано что на старом теелфоне нужно хотя бы раз в недеклю заходит в вацап чтобы на его
клоне он продолжал работаь

еще вот как удобно сделать. на теелефоне где стоит вацап нужно чтобы там не было той симки
с номером вацапа. и чтобы гугл акаунт на этом телефоне был не такой как на старом 
телефоне. тгда на этом телефне вацап будет никак не установить с тем номером.

если злодей завладел симкой. но у нас стоит вацап на другом телефоне то по идее
пока мы на том телефоне не согласны на передачу он не сможет стырить наш вацап. 
но еще надежнее что активирвать пасскод. и тогда без пасскода он тем более не актвиирует.
и PIN задать.


