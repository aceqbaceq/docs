docker

в докере есть прикольный пиздец.

у него есть несколько типов volume.
один из них назыается bind volumes.

это когда мы папку с хоста прокидваем внуьр контейнера.

$ docker run --rm -it   -v /home/vasya/temp/107/01:/01 ubuntu /bin/bash

здесь папка на компе /home/vasya/temp/107/01  пркидывается внуьрь контейнра в папку /01

так вот в чем пиздец:  если папка  /home/vasya/temp/107/01 уже существует на нашем компе то внутри 
контейнера она будет иметь теже пермищнсы что и на компе. едиснвтеннео что в пермишнсах будут указаные
не имена юзеров а их uid\gid тоесть если на космпе эта папка имеет 777 для 1000:1000 то и в контейнере
это будет тоже самое.  пока все охуенно.  НО!!!   если на компе папки /home/vasya/temp/107/01 нет то докер 
при старте контейнера создаст эту папку и права у нее на хосте будут исключетельно root.root !!!! 
причем неважно под каким юзером вы запускаете докер команду под рутом или  обычным енпривлигированным  - создванная
автоматчиески на хосте паапка будет иметь права root.root это пиздец.  это значит что обязательно перед запуском
контейнера надо провреять есть ли папка для волтьюма на хосте или нет. иначе  когда контейнер будет запущен 
то мы получем подмнтрованный volume  в который может пиисать только root. а если унас например стартует 
имадж мускула то это будет полный пиздец. поэтмоу перед стартаом контйенера надо все папки для bind volumes обязательно
на компе подгтоовить чтобы неполучить проблем с file permissions

===
почистить лишнее
$ docker system df
$ docker system prune
$ docker volume prune
$ docker image prune
$ docker builder prune

===
как узнать сколько места занимает тот или иной докер контейнер

$ docker ps --size
CONTAINER ID   IMAGE                    COMMAND                  CREATED        STATUS        PORTS      NAMES                                         SIZE
7d51470e3e99   alpine                   "/bin/sh"                23 hours ago   Up 23 hours              pedantic_hodgkin                              7.08MB (virtual 14.1MB)
aa2ee4d9131c   nginx:alpine             "/docker-entrypoint.…"   43 hours ago   Up 43 hours   80/tcp     vasya_apple.1.5vnmle4p9781joolu6tz086kz       1.09kB (virtual 23.5MB)
cb5297e4dae6   localhost:5000/mysql:1   "docker-entrypoint.s…"   43 hours ago   Up 43 hours   3306/tcp   mysql21_mariadb.1.jt4edmvcwqrzs0d275p8xwail   4B (virtual 491MB)
5e2606ee4349   registry:2               "/entrypoint.sh /etc…"   43 hours ago   Up 43 hours   5000/tcp   registry.1.mp3apml1pk14fj2hog8zxfg8o          0B (virtual 24.2MB)
[vasya@lenovo temp]$ 

====
приолна фича докера. 
$ docker stats 


показаывает сколько цпу , памяти, io  потребялет щас контйеер

$ docker stats имя_конт
CONTAINER ID   NAME       CPU %     MEM USAGE / LIMIT     MEM %     NET I/O      BLOCK I/O       PIDS
fe755ca936d6   gt-php73   0.01%     22.28MiB / 15.39GiB   0.14%     701kB / 0B   100MB / 200MB   8



прикол!

===
