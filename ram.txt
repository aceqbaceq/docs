про RAM.


как  примерно работает  обмен данными  между цпу и RAM.

цпу имеет memory controller. этот контроллер имеет сколько то 
каналов. канал это шина DDR-4 (например эта модель).

обмен данными между модулями памяти и цпу(его мемори контроллером) идет 
по шине DDR.

если мемори контроллер у цпу имеет несколько каналов.это значит
что у него несколько независимых шин DDR.

по каждой шине данные цпу может получать независимо от другой шины.

на мат плате на один канал распаяно несколько слотов под модули памяти.
обычно паяют 2 слота под планки памяти на 1 канал DDR.
возможно есть случаи когда на 1 канал памяти на плате распаяно больше чем 2 слота под
планки памяти. 
значит шина DDR имеет ширину 64-bit , а если с поддержкой ECC то 72-bit.

получается обмен данными междц цпу и памятью идет 64 бита за раз.


теперь вспоминаем что у нас несколько планок памяти на один канал связи.
значит получается они как два IDE диска на 1 шлейфе условно говоря. то есть 
они сидят и мешают друг другу ибо два девайса на одной шине.

и тут придвется еще подробнее узнать как устроены сами планки памяти.

на планке памяти есть чипы в которых можно непосредстенно хранить данные. 
но эти чипы имеют ширину 4 или 8 бит. поэтому чтобы образовать 64 бита
то надо скажем 8 таких чипов. они образуют единую структуру. это как диски 
собранные в рейд0. так вот такая структура чипов которая в итоге дает 64 бит
назыается RANK. так вот создаетли памяти они что творят. они создают планки 
памяти с 1 ранком на планке , с 2 ранками, с 4 ранками. это дает бОльше обьема
на одну планку. идея понятна. как я понимаю есть какието пределы сколько байт 
можно засунуть в один чип тот который 8 бит. и получается что есть ограничение 
сверху по обьему сколько может поместить на данный момент в 1 ранк , в группу
из 8 чипов. учитыая что обычно 2 планки памяти на 1 канал. то получается что 
ест ьсовершенно четки обьем верхнего предела по макс обьему памяти
которую можно получить на канал через две планки с 1 ранком (из 8 чипов).
и если мы хотим еще больше памяти иметь в наличии то приходится лепить 
несколько ранков на одну планку. либо повышат плотность памяти на чип, либо 
увеличивать число каналов памяти итп. походу самый дешевый способ
это засунуть много много ранков на одну планку. 

поэтому получается в итоге на одной шине ( на одном канале памяти) сидит 
сразу куча ранков разбросанных по двум планкам. 

далее помимо чипов с данными на планке памяти есть буфер. 
этот буфер нужен потому что цпу читает данные не из самих чипов напрямую
а из этого буфера.

в целом как я понял система счтыавания из памяти работает так - контроллер памяти
сообщает планке или планкам памяти к какому ранку конкретно контроллер хочет получить
доступ и к какому адресу. потом наступает пауза.  в течение которой планка памяти
копирует данные из чипов в буфер планки памяти. это занимает какоето время.
и потом цпу уже читает данные из этого буфера. 

таким образом имея много ранков мы можем иметь очень большой обьем памяти 
но теярем в скорости потому что чтение происходит в несколько этапов. 

насколько я понимаю при установке модулей в мат плату главное это то что 
цпу его контроллер памяти скорей всего может поддерживать максимально такое то 
число ранков на один канал памяти. а уж как эти ранки будут распределены по двум планкам
мне кажется это недолжео играть роли. скажем  цпу поддержтивает 5 ранков 
на канал. наверно ему пофиг будет что одна планка на 4 ранка а вторая на один
или одна планка на два ранка а вторая на три. надо уточнять.
также я ненашел в спецификации скажем e5-2620v4 сколько максимальное ранков 
памяти в сумме он поддерживате на канал. далее я нашел что nehalem он имеет
три канала памяти и до трех планок на канал. неочень понимаю почему сказано
именно про планки а не про число ранков на канал макмиальное.
ведь планки могут иметь разное число ранков.



также про вот эту многоканальность то что у нас цпу имеет несколько каналов.
я незнаю почему но цпу как японял неможет использовать 
несколько канало водновременно во всех случаях. а может только в определенных.
если планки в обоих каналах одного размера и одной частоты шины то тогда 
проц может одновременно читать с обоих каналов. а если нет то нет.
тогда он за раз читает либо с одного канала либо с другого.
так что от того что несколько каналов еще не занчит что чтение 
идет однрвременно.

поскольку перед тем как считать данные цпу оьявляет из какого ранка
ему нужны данные и так как на одном канале в мнимальном случае сидит как минимум
два ранка (один на одной планке а второй на второй) то я теперь невижу большйо
проблемц что планка имеет боллше чем один ранк.
и мне кажется теперь что планка где много ранков ничуть немедлнее чем планка
с одним ранком.

опять же ранк неимеет никакой связи с тем что на одной стороне планки накленны
чипы или на обоих.

регистровая память она же буферизованная RDIMM, в противоположность им нерегистровая\небуферизо-
ванная DIMM или еще она же UDIMM.

на счет того память имеет ecc корекцию или нет насколько я понял это совсем 
отдельная характеристика несвязанная напрямую с тем rdimm или udimm память.
потому что бывает udimm и в тоже время она имеет ecc

итак

ECC - коррекция ошибок . отдельная независимая фича от всех остальных фич
RDIMM - планка имеет регистры. еще их назвыают буферами. память зовут регистровая
или буферизованная
UDIMM - память без регистра
DIMM - тоже самое что UDIMM


что это за регистры.что они делают. зачем они.
как я понял у любой памяти что с регистрами что без регистров есть линии по которым
цпу присылает команду что ему надо .  а есть линии по которым задается адрес 
с каким ячейками надо это делать. они зовутся линии команд и линии адреса.
так вот вспоминаем что на планке сидит огромная куча 4 или 8 битных чипиков в которых
данные сидят. так вот если регистров нет то каждый из таких чипиков создает
какую то там электрическую нагрузку на эти линии. что это значит напрактике непонятно
но ясно то что чем больше чипиков тем нагрузка больше и это очень плохо.
нашли выход на линию адреса и на линию команд посадили по регистру. 
теперь нагрузка на всю планку упала до уровня нагрузки от одного чипика. 
насколько я понял вся эта хрень относится к проблеме электротехники микросхем.
тоесть с введением регистров в аспекте электротехники все стало замечательно.
но с точки зрения перфоманса случилось вот что. если раньше команда от цпу 
до чипиков на планке долетала за 1 такт то теперь за 1 такт от цпу команда долетает
до регистров. а уже за второй такт регистры передают команду от себя до кишок внутри 
планки. учитывая что вся эта кухня по передаче данных между цпу и памятью занимает 
дохрена тактов то никакой катастрофы нет. никакой ощуимой потери перфоманса нет.
зато стало возможно насовать на планку памяти дохрена ранков. и схемотехника 
контроллера памяти на цпу упростилась. я так понял. 
еще раз как я понял до того как придумали регистры на памяти ввести очень 
сильно устложнялась реализации электротехники контроллера памяти. 

далее как я понял обычно цпу может юзать на канал памяти три планки памяти 
по 2 ранка в каждой. итого 6 ранков на канал.

планки с quad-rank они обычно прописываются отдельно. поддкрэживаются ли они
или нет.

планок с three-rank небывает. только single,dual,quad rank планки.

еще я увидел что если на планке используются чипики по 4 бита то в итоге
на такую планку можно напихать больший обьем.

нашел что xeon e5-v1,2,3,4 имеет 4 канала памяти и поддерживает 8 рангов
на канал



LRDIMM- насколько я пока понял с практической точки зрения ее отличие от RDIMM  втом
что для системы она выглядит так как бутто имеет в два раза меньше ранков на своем
борту. таким макаром получается что можно установить в 2 раза больше ранков
на канал памяти чем это можено сделать через rdimm модули. например - система пооддерживает
8 ранков на канал. значит через rdimm модули можно устанвоить 8 ранков памяти,
а с помощью lrdimm можно установить 16 ранков так как для контроллера памяти будет
казаться что на канале всего 8 ранков памяти.

для примера 160 G9
у него 4 канала памяти. по 2 планки на канал.
судя по книжку он неподдерживает quad-rank rdimm планки.
значит остаются только 2 rank rdimm планки. итого 4 ранка ( 2 планки по 2 ранка ) на канал.
при этом он поддерживает 2 планки по quad-rank lrdimm на канал.



HDIMM-?
FBDIMM-?


такж непонятны пока вопросы:
разница в скрости между планками у которых 1 ранк  2 ранка 3 ранка 4 ракна планка

