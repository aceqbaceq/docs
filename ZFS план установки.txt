ZFS план

ПРИ УСТАНОВКЕ НЕ СОГЛАШАТЬСЯ НА СВАП!
(если все таки свап был создан создать тюнаблс vm.swap_enabled=0)

померить скосркот дисков как блочных утсройста. без ФС

поствить фрибсд.
два хдд диска в рейд0.

intel ssd - померить скорость. и выбрать блок записи по размеру

шпинщдели - убедиться что читается и пишется рекордсайз. (comporess off, *cache=off)  ,без nfs

подобрать оптимльный рекордсайз

влияние arc2

потом щшпиндели + intel 

потом nfs


главный вопрос  - как влияет рекордсайз на пермофанс. чтоб его верно выбрать


после установки mc

   # pkg install mc

нужно постваить баш

   # pkg install bash

и чтобы mc неругался нужно 

   # chsh -s /usr/local/bin/bash

logoff logon 
и теперь mc олжен наормально запускать в фробибсд



Fri Dec 19 19:26:10 MSK 2025
[root@fr-5 /etc]# cp /usr/share/zoneinfo/Europe/Moscow /etc/localtime
[root@fr-5 /etc]# ntpdate ru.pool.ntp.org
19 Dec 22:26:13 ntpdate[4068]: step time server 217.170.87.229 offset +10765.530609 sec
[root@fr-5 /etc]# date
Fri Dec 19 22:26:19 MSK 2025


провериить что на серверах стораджа : 
   в3 и четыре в2 через sas2ircu locate ON успешно подсвечиваются все
      диски. то есть на всех загорется лампокакчка
   на все салазки наклеить серйиные номера дисков
   отработать процедуру замены диска от и до




			
пропписать sysctl vfs.nfsd.srvmaxio=262144 на труенас чтобы в NFS был   rsize=262144,wsize=262144

(!!!!!!)  на зфс все датасеты которые шартся нужно sync=always  (!!!!!!)


на срашариваемую папку не нужно 777 только nobody:wheel


(!!!!!) на FR-1\hst7 нужно при создании пула мирроры соединять из разных стоек! чтоб есл одна стойка целиком отвались то 
при этом миррроры выжили!! (!!!!)

(!!!) приктнуть полку с 8-12 3.5 дисков HP к новому стораджу через сас контроллер??
(!!) добави ьв сервер finer chnahennle карту на свсякий случай и сконфиуировать связь хотя с простой полкой. чтобы потом
когад сервер уже будет в продакшн чтобы не пришось чтото доустанвливать и перезагружат. чтоб фибер ченнел уже был готтов


обязательно выстваить на пуле
	# zpool set cachefile=none POOL-03
	# zpool get all  POOL-03 | grep cache
     POOL-03  cachefile                      none                           local
чтобы его фрибсд не пытался импортровать при загрзуке 


NFS:
как поднть на время

service rpcbind onestart
service mountd onestart
service nfsd onestart

zfs set sharenfs="-alldirs -network 100.69.11.0/24" zpool0/data_shared


проверит arc_max (!!)


(!!) попробовать переделать диски для ОС. из больших на 60ГБ.
     и чтоб зфс перенести. 
     

===
осле пеерзаргрузки фрбибсд автоматом неимпортируем пул.
нужно вытащить пару дисков. 
загрузиться и посмтреть он даст пул смонтировать или нет. 
если не этонемножнго пздец

====

инструия по устанвокее

backup-01.txt

===

иснтуркция по уставноке

baackup-02.txt

===
