| iptables arp
| arp 

если взять иптейлс легаси и вот какой вопрос.

положим берем входящий трафик тоесть таблица
filter а цепочка INPUT и выставляем в деолфтоовой
полиси DROP

*filter
:INPUT DROP [0:0]
...



вопрос заблокирует ли  (сработает ли) эта полиси
если снаружи влетит ARP пакет. 

ОТВЕТ - нет не заблокирует.
этот пакет успешно влетит в комп!
дело вот в чем согласно этой картинке 

		https://wiki.nftables.org/wiki-nftables/index.php/Netfilter_hooks

получается такой момент - вот у нас пакет влетел в
ядро. он туда влетает по любому. далее ядро смотрит
через какой порт влетело этот пакет. Если через L2 
порт то пакет напраляяется на правила ebtables
а если пакет влеетел через L3 порт то ядро далее
проверяет - если это НЕARP пакет то он суется в 
иптбейлс приавла и там прходит проверку, а если это 
ARP пакет то суется в  правила ARPTABLES ! во как!
я буду считать что пакет влеетел чрез L3 порт 
а это значит что ARP пакет будет направлен на arptables
правила. если там есть правило зарещающее то он буде
отброщен а если нет то принят. так что правтла в
иптейблс таблице идут нафиг. они не раотоатют в этом
случае.

теперь на счет что такое L2  L3 порт.
я щас упрощенно скажу что L3 порт этот ккоторый имеет
ИП адрес. а L2 порт это тот который входит в состав
линкс бриджа,причем не тот порт на бридже которйы имеет ИП адрес.  так что в 99% случаев мы имеем L3 порты на практике. 

более тонко что такое L2 порт.

вот у нас сет карта в линуксе. еслли это физ карта
то если ядро сунет в нее пакет то он вылетит в сеть.


      ядро 

       |

      карта

       |

      сеть


если это вирт карта то у нее там где сеть сидит
тоже ядро



      ядро 

       |

      карта

       |

      ядро

так вот главный вопрос что там за кусок ядра сиидит
котоырй "принимает" трафик.
если "за" картой сидит "вирт бридж" (есть такой софт
внутри ядра) то мы имеем дело с L2 портом.

как то еще более круто пока не хочу расписывать.

поэтому если мы в правлах именно иптбейлс все назапр
ещали это еще не значит что у нас запретился ARP трафик!

как проверить

 #arping ...

 



