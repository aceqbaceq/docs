=================
| djvu
| jpg

как взять кучу jpg файлов  и превратить их в многостраничный djvu файл

во первых как посмотреть совйства исходного .JPG файла

    $ exiv2 2101.JPG 
File name       : 2101.JPG
File size       : 1803899 Bytes
MIME type       : image/jpeg
Image size      : 4032 x 3024
Exif Resolution : 4032 x 3024
White balance   : Auto
Thumbnail       : image/jpeg, 7553 Bytes



нам  нужно взять исходные .JPG файл и уменьшить их размер до нужного самим
руками.
потому что утилита c44 которая превршащает в .DJVU она якобы умеет менять 
размер картинки на выходе. но по факту она это нихуя неделает. поэтому едиснт
венный выход это менять размер исходных .JPG картинок
делается это так. например я хочу умньшить размер картинок до 50% от 
исходного размера. это очень охуенно удобная опция

	$ sudo apt-get install imagemagick

  $ for i in *; do  convert -resize 50% $i  $(echo "$(echo $i | rev | cut -c 5- | rev)""-c.jpg") ; done


значит заходим в папку с .JPG файлами и превращаем их в .DJVU файлы
причем  я написал строку команд которая конвертрует кучу  этих файлов в несколько потоков
поэтому на 8-ми процессорах у нас в 8 раз быстрее. а это очень экономит время
конвертация из jpg в djvu идет через утилиту c44

    $ CPU_N="6"; DPI="50"; for i in `ls *.jpg`  ; do echo "$i --> ${i%.jpg}.djvu" ; c44  -dpi "$DPI"   $i   ${i%.jpg}.djvu &  { while [[  $( ps aux | grep c44 | grep -v grep | wc -l )  -eq "$CPU_N" ]] ; do  sleep 1 ; done ; };      done;   { while [[  $( ps aux | grep c44 | grep -v grep | wc -l )  -ge 1 ]] ; do  echo "ждите..."; sleep 1 ; done ; }; echo "готово" 
    
пиздец этой утилиты c44 состоит в том что 
  1) во первых она сука переворачивает исходную страаницу. 
ты такой думаешь ну хуйс ним я щас поверную исхдную страницу и тогда djvu получится нужно ориетации. а хуй там.
это проблема решается на следущем щаге другой утилитой.
  2) вторая проблема в том что параметр c44 -dpi 100 он по факту нихуя ниечего полезного неделает. птому что 
утиита c44 она беерет исходный jpg и его рзмер в точках не меняет. поэтому от того что я выставляяю c44 -dpi 300
или c44 -dpi 100 нихуя ни на что не влияет. размер выходного файла будет одинаковый. и его размер в пикселаях будет
одинаковый. и его степень размытости тоже будет одинаковая. только едиснтвенное в сойствах файла будет 
указано что у него 300 dpi. нахуя это нужно непонятно. оно ничего по факту не дает сука. но мы уже поменяли размер картинки исходных  .JPG файлов 
поэтом нам вроде как это уже ненадо


свойтва файла можно посмотреть вот так

$ djvudump modulus-1#2.djvu 
  FORM:DJVM [67015338] 
    DIRM [1448]       Document directory (bundled, 170 files 170 pages)
    FORM:DJVU [258295] {2101.djvu} [P1]
      INFO [10]         DjVu 4032x3024, v24, 70 dpi, gamma=2.2
      BG44 [52056]      IW4 data #1, 74 slices, v1.2 (color), 4032x3024
      BG44 [72448]      IW4 data #2, 15 slices
      BG44 [133745]     IW4 data #3, 10 slices


видим что указан размер страницы в пикселах и dpi 4032x3024, v24, 70 dpi
еще раз подчеркну какой бы dpi в c44 -dpi ты ни указал это нина что сука не влияет на выходе на самом деле.
поэтому если скажем нужен размер на выходе меньше то нужно уменьшать исходные .JPG файлы



Итак мы получили кучу djvu файлов.
теперь их нужно слепить в один файл мультиистраничный .таже если его погтом пихать на гитхаб
то у гитхаба ограничение на размер файла 100МБ. а в djvu утилитах я не нашел как жерразрезать гтоовый 
мульиистанчный файл на несоклько кусков. поэтому приходится склеивать два djvu файла руками. 
скливаем вот так

    $ djvm -c "./02/modulus-1#2.djvu"     `ls -1 *.djvu | head -n +170`
    $ djvm -c "./02/modulus-2#2.djvu"     `ls -1 *.djvu | tail -n +171`

тоесть первый 170 файлов суются в modulus-1#2.djvu
а остальнлые файлы суются в modulus-2#2.djvu

получили два djvu мультистраниный файла. но это еще не все. помнишь я вговорил что c44 ебанутый
он разворачивыает исходные файлы. теперь их нужно повернуть обратно.
тогда

    $  djvused  "./02/modulus-1#2.djvu"  -e 'set-rotation -45; save'
    $  djvused  "./02/modulus-2#2.djvu"  -e 'set-rotation -45; save'
    
причем утилита тоже ебнутая мы поворачиываем на 90 гардусов но почемуто нужно указатьт 45.


И ВОТ наконец мы из кучи JPG файлоы получили два файла djvu многостранияных. аминь аллилуця.


====

| jpg
| pdf

как взять кучу jpg файлов и слепить из них единый pdf файл

для начала можно уменьшить размер исходныых jpg файлов

  $ sudo apt-get install imagemagick
  $ pacman -Sy imagemagick

  $ for i in *; do  convert -resize 50% $i  $(echo "$(echo $i | rev | cut -c 5- | rev)""-c.jpg") ; done

или вот так

for i in *; do  convert  -resize 50% -monochrome -rotate 90 $i  $(echo "$(echo $i | rev | cut -c 5- | rev)""-c.jpg") ; done



теперь создаем из них один pdf файл
  (взял отсюда https://stackoverflow.com/questions/8955425/how-can-i-convert-a-series-of-images-to-a-pdf-from-the-command-line-on-linux)


  $ img2pdf *.jpg  --pagesize A4    -o out.pdf
в манжаро
  $ magick     -page  A4    *.jpg   -auto-orient   out.pdf

amazing!

==


