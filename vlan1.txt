| vlan


пришел такой вопрос. что если тегированный вилан 
эзернет фрейм влетает в обычный свич который 
не умеет работать с тегированыым трафиком. 

формат фреймов можно тут посмотреть:

https://en.wikipedia.org/wiki/Ethernet_frame

https://lostintransit.se/2024/07/09/802-1q-tagged-frames-through-unmanaged-switch-forwarded-or-dropped/


можно заметить вот что. в формате фрейма нет поля
кторое бы указвало его размер. границы фрейма
отделяют один фрейм от друого фрейма спец полями
такимими как PREAMBLE , InterpacketGAP
тоесть размер пакета опредяется спец набором байтов
слева и спава от фрейма. вот каким макаром свич
опредяет в потоке начало и конец фрейма. 

можно заметить что поля где хранятся мак адреса
они и в обычном фрейме нетегированом и в фрейме
котоыйр тегирваный хрантся в одном месте. поэтому
в целом свич обычный без всяких прблем сможет 
рапсознать мак адреса в тегированом фрейме. 

поэтому по идее получается что если мы сунем тегиро
ванный фрейм в обычный свич то он первый раз пошлет
этот фрейм во все порты. а потом когда узнает 
где он лежит то будет посылать его в нужный порт.
поэтому коряво но все будет работать. потому что
свичу тлоько надо уметь правильно читать в фрейме
условно говоря поля с мак адресами и поле с контроль
ной суммой. ну а вилан тег он только простонапросто
урезает количество портов в котоыре шлется фрйем
и все. их становится меньше.

есть толко один еще тонкий момент. как можно 
замеить из карттнки при передаче фрейма у нас 
помимо самого фрейма (полезных бивтов) еще и ередаются
служебные хрени (премабл. интепакет геп, старт фрейм делимитер). так вот у нас во фрейме нет поля укзающего
длину фрейма но стандарт эзернет указыает макс 
размрешеный размер фрейма это 

  1518 байт для нетгированного
  1522 байта для тегиорванного

а если мы сюда включим еще и обслуживющий хлам(премабл. интепакет геп, старт фрейм делимитер) то 
это будет

  1538 байт
  1542 байт

так вот я о чем - поидее свич когда получил фрейм
то он должен проверить не превысил ли он макс размер
по стадарту. и поучается что тегированный фрейм он может превымсить макс разрешеннйы размер с точки
зрения стдандарта для нетегивранных фреймов.
поэтому по идее свич дожен это обаружить и грохнуть 
такой фрейм. 

почитал в инете - на прааткие свич просто обычно 
без проблем передает этот фрейм дальше.

кстати еще вот что. так как у нас есть всякий 
служеюный хлам при передаче фрейма и этот хлам
отьедает живые биты - ведь их нужно предать то 
получается что част срупута порта выжирается этими 
накладными расходами. ИИ посчитал что если брать макс размер пейлоад то на порту 100МБИт полезная нагрузка будет ~95 MBit/s
а если преедвать фреймы минимального размера (такой
тоже есть в стандарте эзернет сорок с чемто байт)
то тогда полезная сокрость будет 68MBit\s
тоесть порт будет пахать на все 100МБИТ но полезной
нагрузки там будет всего на 68МБИТ вот я о чем

вот такая история
