FC

как я понял ни ceph ни glusterfs неработает через fibre channel.


-------
согласно этому документу 

https://support.hpe.com/hpesc/public/docDisplay?docId=mmr_kc-0100588

HP StorageWorks 8/80 SAN Switch эквивалентен 	Brocade 5300

в этом документе
 https://h20195.www2.hpe.com/v2/getpdf.aspx/c04123373.pdf?ver=7

прописано какие трансиверы этот свич поддерживает:

нас интересует вот этот:
HP 8Gb Shortwave B-series Fibre Channel 1 Pack SFP+ Transceiver = AJ716B

далее я нашел в инете неодно упоминание 
(например вот здесь https://support.hpe.com/hpesc/public/docDisplay?docId=c01486152&docLocale=en_US)  о том что 
		AJ716A is End of Life (EOL), and is replaced by AJ716B because of RoHS compliance; however, the SKU is still orderable until supplies are diminished.


	тоесть то что AJ716A и AJ716B это типа одно и тоже. как японял B просто 
	более экологичный. дело в том что в магазинах сейчас B ненайти зато A попадается очень часто.
	
поэтому с трансиверами к этому свичу мы определились какие он официально
поддерживает.

итак свич есть, трансиверы есть
	
-------


согласно man isp из freebsd

(freebsd)# man isp

 
она поддерживает FC карточки от qlogic серии 

Qlogic 256x (aka 2532)
		   Optical 8Gb Fibre Channel PCIe cards.

 


-------
согласно этому документу 

https://driverdownloads.qlogic.com/QLogicDriverDownloads_UI/HP.aspx?companyid=4


вот эта карточка 

HP StorageWorks 82Q 8Gb Dual Port PCIe Fibre Channel Host Bus Adapter  [AJ764A, QLE2562-HP, 489191-001]

эквиватлента

qlogic QLE2562

поэтому типа она заработает на фрибсд
с другой стороны так как это HP то думаю что со свичом HP она тоже
совместима  поэтому типа эта сет карточка нам подходит

в доке от карточки 
		https://h20195.www2.hpe.com/v2/getdocument.aspx?docname=c04164502#
		написано что вообще то в комплекте с ней идут трансиверы 
		но неуказано какие по модели, но вот в этом документе 
			https://support.hpe.com/hpesc/public/docDisplay?docId=emr_na-c04183658
			который типа говорит о запчастях к этой карточке
			сказано что к этой карте как запасная часть подходит
			трансивер вот такой 468507-001
			я поискал по этому номеру и нашел что это AJ716A.
			тоесть он либо идет с этой картой в комплекте либо по крайней
			мере он с картой совместим.
	

таким образом трансиверы + карточка + свич совместимы друг с другом.
и карточка совместима с freebsd.

хотя вот тут
	https://community.hpe.com/t5/bladesystem-virtual-connect/are-aj716a-and-aj716b-sfp-b-series-compatable/td-p/6680294#.X6BVwNUzY2w
	
	чувак пишет что (как я понял) что у него система на AJ716B незаработала а заработала она только на AJ716A и что типа они несовместимы. этот аспект непонятен.
	

ссылки 
		сет карта
			https://www.westcomp.ru/catalog/fc_8_16gb_s/adapter_hp_storageworks_82q_8gb_dual_port_pcie_fibre_channel_host_bus_adapter_aj764a_489191_001/
		
		здесь пишут что AJ716A и AJ716B трансиверы совместимы
			https://community.hpe.com/t5/hpe-eva-storage/difference-of-part-numbers-of-transceivers/td-p/5842347#.X6BU2NUzbIU
		
			https://forum.ixbt.com/topic.cgi?id=66:10191
		
		кабель
		
			https://www.westcomp.ru/catalog/transivery_opticheskie_kabeli/hp_premier_flex_lc_lc_om4_2f_5m_multi_mode_optical_cable_qk734a_656429_001/
		
		pdf от свича
		
			https://h20195.www2.hpe.com/v2/GetPDF.aspx/c04123373.pdf
		
		pdf вообще по свичам
		
			https://www.intesiscon.com/ficheros/manuales-tecnicos/96-Switch-fibra-HP.pdf
		
		здесь 
			https://it-hp.ru/product/aj716a/
		пишут вот такое:
		
			Общие
			Номер производителя AJ716A
			Название продукта Трансивер HP 8 Гб Shortwave B-series Fibre Channel 1 Pack SFP+

			Основные характеристики
			Тип приемопередающий модуль для коммутатора
			Устройство ЛВС 1 порт (Fibre Channel)
			Пропускная способность 8 Гбит/сек.
			Поддерживаемые стандарты IEEE 802.8 (Fibre Channel)

			Дополнительные характеристики
			Совместимость для систем хранения HP StorageWorks 4400EVA и коммутаторов StorageWorks 4/8 SAN/ 4/32B SAN/ 8/40 SAN/ 8/8 SAN/ 8/80 SAN/ DC SAN Backbone Director
			Интерфейсы 1 x Fibre Channel • SFP
			Системные требования Mini-GBIC

			Доп. информация Трансивер HP AJ716A
			Назначение система хранения • HP StorageWorks 4400EVA
			коммутатор • HP StorageWorks 4/8 SAN
			коммутатор • HP StorageWorks 4/32B SAN
			коммутатор • HP StorageWorks 8/40 SAN
			коммутатор • HP StorageWorks 8/8 SAN
			коммутатор • HP StorageWorks 8/80 SAN
			коммутатор • HP StorageWorks DC SAN Backbone Director

			Родительские устройства
			SAN коммутатор HP StorageWorks 4/8 SAN Switch, монтируемый в шкаф-стойку корпус, 8 портов, Fibre Channel, 1U, ret
			Система хранения информации HP StorageWorks 4400 Enterprise Virtual Array, внешн., жесткие диски: 8 x 400 ГБ, общей ёмкостью до 12 ТБ, черного цвета

		pdf от карточки
		
			https://h20195.www2.hpe.com/v2/getdocument.aspx?docname=c04164502#
		
		здесь пишут какая модель qlogic карточки сидит внутри карточки hp
		
			https://driverdownloads.qlogic.com/QLogicDriverDownloads_UI/HP.aspx?companyid=4
		
		здесь пишут какие модели Brocade лежат внутри некоторых железок HP

			https://www8.hp.com/cn/zh/pdf/HP-RG-160-12_A4_SpreadsMar13_tcm_185_1431155.pdf
	
	
	

==============================


установка

качеаем http://ldriver.qlogic.com/firmware/ql2500_fw.bin
пересобираем initramfs 
 update-initramfs -u
 
 
 проверянм стату реэима раоты карты инициаотор или таргер
 cat /sys/module/qla2xxx/parameters/qlini_mode
 
 /sys/class/fc_host/host4/port_state = показывает вообще кабель то воткнуть есть ли сигнал на уровне L1
 
 =====
 fabric license и full fabric license это одно и тоже
 
 при наличии этой лицензии можно свичи друг с другом сединять
 но только по однрому порту.
 
 а если мы хотим друг сдргуом по несколким портам то нужна дополниельно
 ISL лицензия
 ==
 
 если стоит 
 full ports on demand license на 32 портов
 
 и стоит одновременно 
 second ports on demand license на 16 портов
 
 и еще может там какието он деманд лицензи
 так вот суммарное число активироавнных он деманд
 портов полюбому неможет превыщать число 32 которое указано
 в лицензии full ports on demand license
 =====
 если скорость портов указан через N
 например N8 
 то буква N ознавает что настройка порту = negotiate
 то есть она предлагает устройству конечному такую скорость.
 
 есть другой варианть настройки скорсти порта , когамы жестко
 задаем скажем 8ГБ.
 тогда буквы N не будет в статусе скрости поартов
 
 ====
 brocade
 
 default passwords
 
 root:fibranne
 admin:password
 user:password
 
 =======
 brocade
 без заебов не обошлось
 все для людей.
 
 значит в завимиости от версии FOS его веб морда работает т
 только с определенной версией jre
 
 https://downloads.hpe.com/pub/softlib2/software1/pubsw-windows/p199020807/v143212/FOS7.4.1d_RN.pdf
 
 страница 45
 
 это пишут люди и это написано в руководстве.
 
 например 
 
 FOS v7.4.0 is qualified and supported with Oracle Java version 7 update 76 and Java version 8 update 66.
 
 у меня конкретно работает такая связка:
 
 FOS v7.4.1d + jre8u66(64bit)
 FOS v7.4.1d + jre8u251(32bit)
 
 далее надо зайти в контрол панель в виндовсе в java и там
 в закладе security добавить путь к свичу как безопасный
 например 
 http://10.15.0.10
 
 и также суперважно что запускать веб морду надо не вбраузере там вобще ноль на массе 
 а в командной строке:
 
 "c:\Program Files\Java\jre1.8.0_66\bin\javaws.exe" http://10.15.0.10/switchExplorer_installed.html
 
  
 
 
 ===
 brocade
 
 настроить через cli адрес веб морды
 
 > ipaddrset
 
 ====
 