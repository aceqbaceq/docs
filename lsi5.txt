| lsi 
| 2308
| 9207


как перепрошить прошивки с IT на IR и наоборот.

нужно создать загрузочнкую DOS флэшку.
это оябазтельно только под DOS утилите умеет перешивать контролллер
с IR на IT и с IT на IR.


длаее если контролллер 6Gb/s то нужна 


    sas2flsh.exe


обрашаю внимание что именно эта а не sas2flash.exe

а если контроллер 12Gb/s то нужна


    sas3flsh.exe


это все надо качать на сайте broadcom по слову такойто контроллер FIRMWARE.

вобще на сайте broadcom хер найдешь меню откуда качать файлы вот оно

   https://www.broadcom.com/support/download-search

если чип 2308 то нужно искать карту LSI 9217-8i и нужно искать файлы вида


Installer_P10_for_Linux.zip
Installer_P16_for_MSDOS_and_Windows.zip


внутри них мы найдет утилиту 


  sas2flsh.exe\sas3flsh.exe

под DOS

это толко программа прошивкалка. 

нам нужно еще два файла
например для 9217-8i это 


	9207-8.bin
	mptsas2.rom


их нужно искать в файле

   9217_8i_Package_P20_IR_IT_FW_BIOS_for_MSDOS_Windows.zip


а если чип 3008 то это карта LSI 9300-8i и нужно искать файлы

mptsas3.rom
SAS9300_8i_IT.bin



итого нужно собрать вместе три файла  в одну папку на загруочной флэкшке с DOS



mptsas3.rom
sas3flsh.exe
SAS9300_8i_IT.bin


либо 


9207-8.bin
mptsas2.rom
sas2flsh.exe

(в зависимости от контроллера который шьем)


грузмися с этой флэшки .
далее вот что делаем



  # sas2flsh.exe  -c 0 -list

здест нужнозаписать на бумажку SAS адрес карты. он потом будет нужен.

теперь нужно стереть флэш на карте

 # sas2flsh.exe -c 0 -o -e 6

теперь выклчюать комп нельщя

прошиваем карту

 # sas2flsh.exe  -c 0  -o  -f 9207-8.bin   -b mptsas2.rom

UPDATE!!!!! если мы хотим чтобы у нас загрузочная хрень была нетолко в BIOS но и в UEFI тогда нужно добыть еще один файл mpt3x64.rom
и прошивать нужно тогда вот так


 # sas2flsh.exe  -c 0  -o  -f 9207-8.bin   -b mptsas2.rom   -b x64sas3.rom


 если все  окей то возврашаем контролллеру ранее имевищйся SAS адрес

# sas2flsh.exe -c 0 -o -sasadd 50605...8b7

проверяыем что все окей

 # sas2flsh.exe  -c 0 -list

а что значит окей? а вот что 


root@backup-01:~# sas3flash -list
Avago Technologies SAS3 Flash Utility
Version 16.00.00.00 (2017.05.02) 
Copyright 2008-2017 Avago Technologies. All rights reserved.

    Adapter Selected is a Avago SAS: SAS3216(A1)

    Controller Number              : 0
    Controller                     : SAS3216(A1)
    PCI Address                    : 00:04:00:00
    SAS Address                    : 500062b-2-029b-6a40
    NVDATA Version (Default)       : 0b.04.00.05
    NVDATA Version (Persistent)    : 0b.04.00.05
    Firmware Product ID            : 0x2228 (IT)  <<*** если здесьт стоит (IT) значит карта в HBA прошивке а если (IR) то в рейд прошивке
    Firmware Version               : 15.00.00.00
    NVDATA Vendor                  : LSI
    NVDATA Product ID              : SAS9305-16e
    BIOS Version                   : 08.35.00.00  <<**** если здесь непусто значит у карты загружен ROM для BIOS
    UEFI BSD Version               : 17.00.00.00  <<*** если здес непусто то знчит у карты загружен ROM для UEFI
    FCODE Version                  : N/A
    Board Name                     : SAS9305-16e
    Board Assembly                 : N/A
    Board Tracer Number            : N/A

    Finished Processing Commands Successfully.
    Exiting SAS3Flash.




если карта новая(12GB/s каналы)  то ссмотрим ее через sas3flash а если старая (6Gb/s каналы) то через sas2flash



готово. перегружаемся.


UPDATE:
наипиздатейшая папка с прошивками от LSI

    https://dns.abacus.cz/support/FW/STORAGE/LSI/

только она открывается с албанских IP





еще важная хрень. тут есть uefi прошивка (  x64sas2.rom) 
https://artofserver.com/downloads/lsi/firmware/sas2308/p20/


